<p align="center">
  <a href="" rel="noopener">
 <img width=200px height=200px src="https://www.fora.si/uploads/perception/images/benefits/secure_2.png" alt="Project logo"></a>
</p>

<h3 align="center">Secure coding</h3>

<!-- <div align="center">

[![Status](https://img.shields.io/badge/status-active-success.svg)]()
[![GitHub Issues](https://img.shields.io/github/issues/kylelobo/The-Documentation-Compendium.svg)](https://github.com/jyos1426/secure_code/issues)

</div> -->

<p align="center"> ì‹œíì–´ ì½”ë”©ì— ëŒ€í•œ ê¸°ìˆ ì¡°ì‚¬ ë° ìƒ˜í”Œë§
    <br> 
</p>

# ğŸ“ Table of Contents

* [1. ì‹œíì–´ ì½”ë”©ì— ëŒ€í•œ ê¸°ìˆ ì¡°ì‚¬](#search)
* [2. í”„ë¡œì íŠ¸ ë°˜ì˜ ê¸°ìˆ  ì„ ì •](#selected)
* [3. ì°¸ê³  ë¬¸í—Œ](#refer)
<br><br>

# ğŸ§ ì‹œíì–´ ì½”ë”©ì— ëŒ€í•œ ê¸°ìˆ ì¡°ì‚¬ <a name = "search"></a>


## 1. [Angular.io](https://angular.io/guide/security)
Angularì— ë‚´ì¥ë˜ì–´ìˆëŠ” ë³´ì•ˆ ê¸°ìˆ ì—ëŒ€í•´ ì„¤ëª…

Preventing cross-site scripting (XSS)
1. Angularì˜ XSS ë°©ì–´ ëª¨ë¸ <br>
: í”„ë ˆì„ì›Œí¬ ê³„ì¸µì—ì„œ XSS ê³µê²©ì„ ë°©ì–´í•˜ê¸° ìœ„í•´ ê¸°ë³¸ì ìœ¼ë¡œ AngularëŠ” ëª¨ë“  ê°’ì„ ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼í•œë‹¤. í…œí”Œë¦¿ DOMì— ì¶”ê°€ë˜ëŠ” values, properties, attributes, style, class binding, string bindingì€ ëª¨ë‘ Angularê°€ ì•ˆì „ì„±ì„ ê²€ì‚¬í•˜ê³  ë³´ì•ˆì— ìœ„ë°°ë˜ëŠ” ê°’ì„ ì œê±°í•œë‹¤.
2. ì½”ë“œ ì•ˆì „ì„± ê²€ì‚¬(Sanitization) ì™€ ë³´ì•ˆ ì˜ì—­(security contexts)
* HTML ë³´ì•ˆ ì˜ì—­: ì–´ë–¤ ê°’ì´ HTMLë¡œ ë³€í™˜ë˜ëŠ” ê²½ìš° (innerHTML)
* ìŠ¤íƒ€ì¼ ë³´ì•ˆ ì˜ì—­: style í”„ë¡œí¼í‹°ë¡œ CSS ì½”ë“œê°€ ë°”ì¸ë”©ë˜ëŠ” ê²½ìš°
* URL ë³´ì•ˆ ì˜ì—­: a href ì™€ ê°™ì€ ì—˜ë¦¬ë¨¼íŠ¸ì— URL í”„ë¡œí¼í‹°ê°€ ì‚¬ìš©ë˜ëŠ” ê²½ìš°
* ë¦¬ì†ŒìŠ¤ URL ë³´ì•ˆ ì˜ì—­: script src ì™€ ê°™ì´ ì™¸ë¶€ ì½”ë“œë¥¼ ë¡œë“œí•´ì„œ ì‹¤í–‰í•˜ëŠ” ê²½ìš°
3. ì•ˆì „ì„± ê²€ì‚¬ ì˜ˆì œ
<br> : [ìƒ˜í”Œë§ ì½”ë“œ ì°¸ê³ ](#sampling01)
4. DOM APIë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì™€ ëª…ì‹œì ìœ¼ë¡œ ì•ˆì „ì„± ê²€ì‚¬ë¥¼ ì‹¤í–‰í•˜ëŠ” ê²½ìš°
<br> : ElementRefë¡œ ì°¸ì¡°í•  ìˆ˜ ìˆëŠ” document ë…¸ë“œë‚˜ ì„œë“œ íŒŒí‹° APIì—ëŠ” ë³´ì•ˆì— ì·¨ì•½í•œ ë©”ì†Œë“œê°€ ì¡´ì¬í•  ìˆ˜ ìˆìŒ
<br> : ë”°ë¼ì„œ DOMì„ ì§ì ‘ ì¡°ì‘í•˜ì§€ ë§ê³  Angularì˜ í…œí”Œë¦¿ì„ ìµœëŒ€í•œ í™œìš©
<br> : ì•ˆì „ì´ í™•ì¸ë˜ì§€ ì•Šì€ ì½”ë“œì— DomSanitizer.sanitize ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ Angularê°€ ìë™ìœ¼ë¡œ êµ¬ì„±í•˜ëŠ” ê²ƒê³¼ ê°™ì€ SecurityContextë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŒ
5. ì•ˆì „í•œ ê°’ìœ¼ë¡œ ê°„ì£¼í•˜ê¸°
<br> : 1ë²ˆ ì™¸ì˜ ê°’ì„ ì‚¬ìš©í•´ì•¼í•  ì‹œ DomSanitizerë¥¼ ì‚¬ìš©í•´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê°’ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì‚¬ìš© 
<br>: [ìƒ˜í”Œë§ ì½”ë“œ ì°¸ê³ ](#sampling02)
- Content-Security-Policy HTTP í—¤ë” ì‚¬ìš©
- AOT template compiler
<br> : template injection ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ëª¨ë“  ì¢…ë¥˜ì˜ ì·¨ì•½ì„±ì„ ë°©ì§€
<br> Angular CLI applicationì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ì»´íŒŒì¼ëŸ¬ë¡œ, ëª¨ë“  í”„ë¡œë•ì…˜ ë°°í¬ì— ì‚¬ìš©í•´ì•¼ í•¨
- ì„œë²„ì—ì„œ XSS ê³µê²© ë°©ì–´
<br> : ì„œë²„ì—ì„œ Angular í…œí”Œë¦¿ì„ ìƒì„±í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ìŒ

HTTP ê³„ì¸µ ì·¨ì•½ì 

- Cross-site request forgery
<br>: Angularê°€ ì œê³µí•˜ëŠ” HttpClientì€ same origin policyì„ ì¤€ìˆ˜í•˜ê¸° ë•Œë¬¸ì— XSRF ê³µê²©ì„ ë°©ì–´ê°€ëŠ¥
- Cross-site script inclusion (XSSI)
<br>: Angularê°€ ì œê³µí•˜ëŠ” HttpClient ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ ì´ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©°, ì‘ë‹µì„ íŒŒì‹±í•œ ë’¤ì—ëŠ” ")]}',\n" ë¬¸ìì—´ì„ ìë™ìœ¼ë¡œ ì œê±°í•¨

## 2. Angular Security Best Practices ([Angular-Security-Best-Practices.pdf](https://snyk.io/wp-content/uploads/Angular-Security-Best-Practices-1.pdf))
<br>

- The â€œAngular wayâ€ safeguards you from XSS
<br> Interpolation({{ }})ì„ ì‚¬ìš©í•˜ì—¬ ì ì¬ì ìœ¼ë¡œ ìœ„í—˜í•œ ë¬¸ìë¥¼ ì•ˆì „í•˜ê²Œ ì¸ì½”ë”©í•˜ê³  í…œí”Œë¦¿ ì‹ ë‚´ì—ì„œ ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” HTML ë˜ëŠ” CSS ì‹ì„ escape

- Use innerHTML with caution
<br> HTMLì„ êµ¬ì„±ìš”ì†Œì— ë™ì ìœ¼ë¡œ ì¶”ê°€í•´ì•¼ í•˜ëŠ” ê²½ìš° [innerHTML] ìœ„ì¹˜ì— ìƒì„± ë°”ì¸ë”©

- Never use templates generated by concatenating user input
<br> ì‚¬ìš©ì ì…ë ¥ì„ ì—°ê²°í•˜ì—¬ ìƒì„±í•œ í…œí”Œë¦¿ì„ ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ
```
const potentialUserInput = `
  <!-- ì ì¬ì  ì‚¬ìš©ì ì…ë ¥ -->
  <img src="x" onError="javascript:console.log({cookie: window.document.cookie});">
`;

@Components({
  template: `
  <div class="job">
    {{data.body}}
  <div>
  ` + potentialUserInput
})
export class TestComponent  {
  @Input() data: any;
}
```
ì´ëŸ¬í•œ ì·¨ì•½ì„± ë°©ì§€í•˜ê¸° ìœ„í•´ After of Time ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤í”„ë¼ì¸ìœ¼ë¡œ í…œí”Œë¦¿ì„ ì»´íŒŒì¼í•  ê²ƒì„ ê¶Œì¥
```
ng build --aot
ng serve --aot
```

- Never use native DOM APIs to interact with HTML elements
<br> - ì¼ë°˜ì ìœ¼ë¡œ í”¼í•´ì•¼í•  ì‚¬í•­
<br> 1. node.appendChild(); ì‚¬ìš©
<br> 2. pageì™€ ìƒí˜¸ì‘ìš© í•˜ê¸°ìœ„í•œ document ê°ì²´ ë©”ì†ŒìŠ¤ ì‚¬ìš©
<br> 3. jquery API ì‚¬ìš©

- Avoid template engines on server-side templates
<br> Angular server rendering applicationì— 3rd party template engineì‚¬ìš©ì„ í”¼í•¨


- Scan your Angular project for components which introduce security vulnerabilities
<br> npm audit ë˜ëŠ” snykë¥¼ ì‚¬ìš©í•˜ì—¬ Angular í”„ë¡œì íŠ¸ ì˜¤í”ˆ ì†ŒìŠ¤ ì¢…ì†ì„± ë° Angular êµ¬ì„± ìš”ì†Œì—ì„œ ë³´ì•ˆ ì·¨ì•½ì ì„ ê²€ìƒ‰
<br> [Snyk](#synk) í”Œë«í¼ ë˜ëŠ” CLIë¥¼ ë¬´ë£Œë¡œ ì‚¬ìš©í•˜ì—¬ ë³´ì•ˆ ì·¨ì•½ì ì„ ì°¾ì•„ ìˆ˜ì •í•˜ê³  ëª¨ë‹ˆí„°ë§

<br>

---
<br>

# ğŸ”§ í”„ë¡œì íŠ¸ ë°˜ì˜ ê¸°ìˆ  ì„ ì • <a name = "selected"></a>

## 1. innerHTML ì‚¬ìš© ì˜ˆì‹œ <a name = "sampling01"></a>
- src/app/inner-html
```
<p [innerHTML]="htmlSnippet"></p>
```
## 2. DomSanitizer ì‚¬ìš© ì˜ˆì‹œ <a name = "sampling02"></a>

- src/app/bypass-security<br>

DOM ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡, ìœ„í—˜í•œ ê°’ì„ ì‚­ì œí•˜ì—¬ ì‚¬ì´íŠ¸ ê°„ ìŠ¤í¬ë¦½íŒ… ë³´ì•ˆ ë²„ê·¸ (XSS)ë¥¼ ë°©ì§€í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤

```
abstract class DomSanitizer implements Sanitizer {
  abstract sanitize(context: SecurityContext, value: string | SafeValue): string | null
  abstract bypassSecurityTrustHtml(value: string): SafeHtml
  abstract bypassSecurityTrustStyle(value: string): SafeStyle
  abstract bypassSecurityTrustScript(value: string): SafeScript
  abstract bypassSecurityTrustUrl(value: string): SafeUrl
  abstract bypassSecurityTrustResourceUrl(value: string): SafeResourceUrl
}
```

## 3. snyk - [https://snyk.io](https://snyk.io/) <a name = "snyk"></a>
í”„ë¡œì íŠ¸ì˜ ì˜ì¡´ì„±ì„ ê²€ì‚¬í•´ì„œ ì‚¬ìš©ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬(npm packages)ì˜ ì·¨ì•½ì ì„ í™•ì¸í•˜ëŠ” ë³´ì•ˆ ë„êµ¬, tool chainì— ì—°ë™í•˜ì—¬ commit ì´ë‚˜ build, CI/CD ì‹œ ìë™ ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥, container image ë„ ê²€ì‚¬ê°€ëŠ¥
```
npm install -g snyk
snyk test
```
- ê²€ì‚¬ ê²°ê³¼ ì˜ˆì‹œ
```
[root@localhost secure_code]# snyk test

Testing /workspace/secure_code...

Organization:      jyos1426
Package manager:   npm
Target file:       package-lock.json
Project name:      secure-coding
Open source:       no
Project path:      /workspace/secure_code
Licenses:          enabled

âœ“ Tested 12 dependencies for known issues, no vulnerable paths found.
```
# ğŸ”§ ì°¸ê³  ë¬¸í—Œ <a name = "refer"></a>

- [lesstif](https://www.lesstif.com/security/owasp-2020-10-91291830.html#OWASP202010%EB%8C%80%EC%B7%A8%EC%95%BD%EC%A0%90-A1.Injection(%EC%9D%B8%EC%A0%9D%EC%85%98)) - OWASP 2020 10ëŒ€ ì·¨ì•½ì 
- [kisa](https://www.kisa.or.kr/public/laws/laws3_View.jsp?cPage=6&mode=view&p_No=259&b_No=259&d_No=52&ST=T&SV=) - ê¸°ìˆ ì•ˆë‚´ì„œ ê°€ì´ë“œ
- [Angular-Security-Best-Practices](https://snyk.io/wp-content/uploads/Angular-Security-Best-Practices-1.pdf)
- [Angular.io](https://angular.io/guide/security)

---
<br>

ì‘ì—…í•œ ì„œë²„ì˜ ì‹œê°„ì´ ì‹¤ì œë³´ë‹¤ 3ì‹œê°„ì •ë„ ëŠë¦½ë‹ˆë‹¤. commit ì‹œê°„ì€ ë¬´ì‹œí•´ ì£¼ì„¸ìš”~ 

<br>

![alt text](./date.png)